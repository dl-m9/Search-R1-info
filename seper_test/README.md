# SePer é›†æˆæµ‹è¯•å¥—ä»¶

æœ¬ç›®å½•åŒ…å« SePer ä¸ Search-R1 é›†æˆçš„å®Œæ•´æµ‹è¯•å¥—ä»¶ã€‚

## ğŸ“ æµ‹è¯•æ–‡ä»¶

### æ ¸å¿ƒæµ‹è¯•
- **`test_core.py`** - æ ¸å¿ƒåŠŸèƒ½æµ‹è¯• âœ… æ¨èé¦–å…ˆè¿è¡Œ
- **`test_fixed.py`** - ä¿®å¤ç‰ˆæœ¬æµ‹è¯•ï¼ˆé¿å…å¯¼å…¥å†²çªï¼‰
- **`test_simple.py`** - ç®€åŒ–çš„ç»“æ„æµ‹è¯•

### å®Œæ•´æµ‹è¯•
- **`test_seper_integration.py`** - å®Œæ•´é›†æˆæµ‹è¯•ï¼ˆéœ€è¦æ¨¡å‹ï¼‰
- **`test_seper_minimal.py`** - æœ€å°ç»“æ„æµ‹è¯•
- **`test_seper_quick.py`** - å¿«é€ŸåŠŸèƒ½æµ‹è¯•

### è‡ªåŠ¨åŒ–è¿è¡Œ
- **`run_tests.sh`** - è‡ªåŠ¨åŒ–æµ‹è¯•è¿è¡Œå™¨

## ğŸš€ æ¨èæµ‹è¯•æµç¨‹

### 1. å¿«é€ŸéªŒè¯ï¼ˆæ¨èï¼‰
```bash
cd Search-R1-info/seper_test
python test_core.py
```

### 2. å®Œæ•´æµ‹è¯•å¥—ä»¶ï¼ˆå¯é€‰ï¼‰
```bash
cd Search-R1-info/seper_test
./run_tests.sh
```

### 3. å•ç‹¬è¿è¡Œç‰¹å®šæµ‹è¯•
```bash
# æ ¸å¿ƒåŠŸèƒ½æµ‹è¯•
python test_core.py

# åŸºæœ¬ç»“æ„æµ‹è¯•
python test_simple.py

# å®Œæ•´é›†æˆæµ‹è¯•ï¼ˆéœ€è¦GPUï¼‰
python test_seper_integration.py
```

## âœ… æµ‹è¯•çŠ¶æ€

### å½“å‰çŠ¶æ€
- âœ… **æ–‡ä»¶ç»“æ„å®Œæ•´** - æ‰€æœ‰å¿…éœ€æ–‡ä»¶å­˜åœ¨
- âœ… **åŸºæœ¬åŠŸèƒ½å¯ç”¨** - SePer è®¡ç®—å™¨å¯ä»¥åˆ›å»º
- âœ… **é…ç½®æ­£ç¡®** - è®­ç»ƒè„šæœ¬åŒ…å« SePer è®¾ç½®
- âœ… **æ¨¡å—å¯åŠ è½½** - å¥–åŠ±å‡½æ•°å¯ä»¥å¯¼å…¥

### å·²çŸ¥é—®é¢˜
- âš ï¸ å¯¼å…¥è­¦å‘Šï¼ˆä¸å½±å“åŠŸèƒ½ï¼‰
- âš ï¸ å®Œæ•´æµ‹è¯•éœ€è¦ GPU ç¯å¢ƒ
- âš ï¸ éƒ¨åˆ†æµ‹è¯•éœ€è¦ä¾èµ–åŒ…å®‰è£…

## ğŸ“Š æµ‹è¯•ç»“æœè§£è¯»

### æˆåŠŸè¾“å‡ºç¤ºä¾‹
```
ğŸ§ª SePer Core Integration Test
==================================================
âœ… All essential files present
âœ… SePer integration structure is complete
âœ… Training scripts are configured
âœ… Basic functionality is available
âœ… SUCCESS
```

### å¦‚æœæµ‹è¯•å¤±è´¥
1. **æ–‡ä»¶ç¼ºå¤±** - æ£€æŸ¥è·¯å¾„å’Œæ–‡ä»¶å­˜åœ¨æ€§
2. **å¯¼å…¥é”™è¯¯** - å®‰è£…ç¼ºå°‘çš„ä¾èµ–åŒ…
3. **æƒé™é—®é¢˜** - æ£€æŸ¥æ–‡ä»¶æƒé™

## ğŸ”§ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

#### 1. æ–‡ä»¶è·¯å¾„é”™è¯¯
```bash
# æ£€æŸ¥æ˜¯å¦åœ¨æ­£ç¡®ç›®å½•
pwd
# åº”è¯¥æ˜¾ç¤º: .../Search-R1-info/seper_test
```

#### 2. Python è·¯å¾„é—®é¢˜
```bash
# ç¡®ä¿å¯ä»¥è®¿é—®æ¨¡å—
python -c "import sys; print(sys.path)"
```

#### 3. ä¾èµ–åŒ…ç¼ºå¤±
```bash
# å®‰è£…åŸºæœ¬ä¾èµ–
pip install torch transformers numpy
```

## ğŸ“ æµ‹è¯•è¦†ç›–èŒƒå›´

### âœ… å·²è¦†ç›–
- æ–‡ä»¶ç»“æ„å®Œæ•´æ€§
- åŸºæœ¬æ¨¡å—å¯¼å…¥
- SePer è®¡ç®—å™¨åˆ›å»º
- è®­ç»ƒè„šæœ¬é…ç½®
- æ¨¡å‹è‡ªåŠ¨æ£€æµ‹é€»è¾‘

### âš ï¸ éƒ¨åˆ†è¦†ç›–
- å®Œæ•´æ¨¡å‹åŠ è½½ï¼ˆéœ€è¦ GPUï¼‰
- ç«¯åˆ°ç«¯å¥–åŠ±è®¡ç®—ï¼ˆéœ€è¦ä¾èµ–ï¼‰
- å®é™…è®­ç»ƒè¿è¡Œï¼ˆéœ€è¦æ•°æ®å’Œç¯å¢ƒï¼‰

## ğŸš€ æµ‹è¯•é€šè¿‡åçš„æ­¥éª¤

å¦‚æœ `test_core.py` é€šè¿‡ï¼Œè¯´æ˜ SePer é›†æˆå·²ç»å°±ç»ªï¼š

1. **å¯åŠ¨æ£€ç´¢æœåŠ¡å™¨**
   ```bash
   conda activate retriever
   bash retrieval_launch.sh
   ```

2. **è¿è¡Œ SePer å¢å¼ºè®­ç»ƒ**
   ```bash
   conda activate searchr1
   bash train_grpo_seper.sh
   ```

3. **ç›‘æ§è®­ç»ƒæ—¥å¿—**
   ```bash
   tail -f nq-search-r1-grpo-seper-qwen2.5-3b-em.log
   ```

4. **æŸ¥çœ‹ SePer åˆ†æ•°**
   åœ¨è®­ç»ƒæ—¥å¿—ä¸­æŸ¥æ‰¾ï¼š
   - `seper/delta_mean`: å¹³å‡ Î”SePer åˆ†æ•°
   - `seper/retrieval_mean`: å¹³å‡æ£€ç´¢å SePer
   - `critic/rewards/mean`: ç»¼åˆå¥–åŠ±

## ğŸ“‹ æµ‹è¯•æ¸…å•

è¿è¡Œæµ‹è¯•å‰ç¡®è®¤ï¼š

- [ ] åœ¨ `Search-R1-info/seper_test/` ç›®å½•ä¸‹
- [ ] Python ç¯å¢ƒå·²æ¿€æ´»
- [ ] æ‰€æœ‰å¿…éœ€æ–‡ä»¶å­˜åœ¨
- [ ] è·¯å¾„é…ç½®æ­£ç¡®

è¿è¡Œæµ‹è¯•åæ£€æŸ¥ï¼š

- [ ] æ ¸å¿ƒæµ‹è¯•é€šè¿‡
- [ ] æ— å…³é”®é”™è¯¯ä¿¡æ¯
- [ ] å¯ä»¥åˆ›å»º SePer è®¡ç®—å™¨
- [ ] è®­ç»ƒé…ç½®æ­£ç¡®

## ğŸ”— ç›¸å…³æ–‡ä»¶

- **é›†æˆä»£ç **: `../verl/utils/reward_score/seper_reward.py`
- **è®­ç»ƒè„šæœ¬**: `../train_grpo_seper.sh`
- **é…ç½®æ–‡ä»¶**: `../verl/trainer/config/ppo_trainer_seper.yaml`
- **ä¸»æ–‡æ¡£**: `../SEPER_INTEGRATION.md`